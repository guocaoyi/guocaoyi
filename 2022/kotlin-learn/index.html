<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>菜鸟《Kotlin 教程》笔记 | Yalda&#39;s blogs</title>
  <meta name="author" content="Yalda Guo">
  
  <meta name="description" content="sxx">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="菜鸟《Kotlin 教程》笔记"/>
  <meta property="og:site_name" content="Yalda&#39;s blogs"/>

  
    <meta property="og:image" content=""/>
  

  
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  
<!-- baidu analytics -->
<script>
  var _hmt = _hmt || [];
  (function () {
    // domain !== yalda.cn, return
    if (window.location.hostname !== 'yalda.cn') return;

    var hm = document.createElement('script');
    hm.src = 'https://hm.baidu.com/hm.js?b6ea6ca0c389aa294890b81f26dcc186';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>

 
<!-- Google tag (gtag.js) -->

<script
  async
  src="https://www.googletagmanager.com/gtag/js?id=G-RGH70FJBTF"
></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() {
    dataLayer.push(arguments);
  }
  gtag('js', new Date());

  gtag('config', 'G-RGH70FJBTF');
</script>



<meta name="generator" content="Hexo 7.0.0"></head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">Yalda&#39;s blogs</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class=""></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class=""></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class=""></i>About
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header">
			<h1> 菜鸟《Kotlin 教程》笔记</h1>
		</div>
	



<div class="row post">
	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  		

	  <h1 id="菜鸟《Kotlin-教程》笔记"><a href="#菜鸟《Kotlin-教程》笔记" class="headerlink" title="菜鸟《Kotlin 教程》笔记"></a>菜鸟《Kotlin 教程》笔记</h1><h2 id="Kotlin-基础"><a href="#Kotlin-基础" class="headerlink" title="Kotlin 基础"></a>Kotlin 基础</h2><h3 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h3><ul>
<li>由 JetBrians 设计并开源</li>
<li>Kotlin 不仅仅是一门 JVM 方言（分为 Kotlin Native \ Kotlin JS \ Kotlin JVM）</li>
<li>Google I&#x2F;O 2017 年作为 Android 官方首选开发语言</li>
<li>文件以 <code>.kt</code> 结尾（其中脚本 DSL 以 <code>.kts</code> 结尾）</li>
<li>无需匹配目录和包（不同于 Java 一个文件一个类），可以放在任何文件和目录</li>
</ul>
<h3 id="优势"><a href="#优势" class="headerlink" title="优势"></a>优势</h3><ul>
<li>简洁：大大减少样板代码的数量<ul>
<li>结构性的 get&#x2F;set、构造函数、单例</li>
<li>字面量创建 List&#x2F;Map</li>
</ul>
</li>
<li>安全：语法层面避免空指针异常</li>
<li>互操作性：充分利用 JVM 、 Android 和浏览器的现有库</li>
<li>体验一致的开发工具链</li>
<li>支持拓展（类似与 Swift 的 extension）；操作符重载</li>
<li>语法糖很多<ul>
<li>通过语法糖实现了一下基本设计模式（单例、委托、策略、观察者等）</li>
</ul>
</li>
</ul>
<span id="more"></span>

<h3 id="劣势"><a href="#劣势" class="headerlink" title="劣势"></a>劣势</h3><ul>
<li>语法糖太多（软性关键字被占用），导致语义复杂；而要理解这些语法糖，需要了解 Java 的实现</li>
<li>包体积变大（Kotlin 库文件）</li>
<li>编译时略长（涉及到往 Java 字节码的转译）</li>
<li>开源不彻底；命令行工具链不完善（深度绑定IDE）</li>
</ul>
<h3 id="CLI"><a href="#CLI" class="headerlink" title="CLI"></a>CLI</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -d 设置输出名称</span></span><br><span class="line"><span class="comment"># -include-runtime .jar 文件包含 Kotlin 运行库</span></span><br><span class="line">kotlinc hello.kt -include-runtime -d hello.jar</span><br><span class="line">java -jar hello.jar</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成的 jar 给其他 Kotlin 代码使用，无需包含 Kotlin 运行时库</span></span><br><span class="line">kotlinc hello.kt -d hello.jar</span><br><span class="line"></span><br><span class="line"><span class="comment"># HelloKit 默认类名</span></span><br><span class="line">kotlin -classpath hello.jar HelloKit</span><br></pre></td></tr></table></figure>

<h3 id="REPL"><a href="#REPL" class="headerlink" title="REPL"></a>REPL</h3><p><code>bin/kotlinc-jvm</code></p>
<h3 id="脚本语言-kts"><a href="#脚本语言-kts" class="headerlink" title="脚本语言 .kts"></a>脚本语言 .kts</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// list_folders.kts</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> folders = File(args[<span class="number">0</span>]).listFiles &#123; file -&gt; file.isDirectory() &#125;</span><br><span class="line">folders?.forEach &#123; folders -&gt; println(folder) &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kotlinc -script list_folders.kts ./</span><br></pre></td></tr></table></figure>

<h2 id="基础语法"><a href="#基础语法" class="headerlink" title="基础语法"></a>基础语法</h2><h3 id="默认-导入到每个-Kotlin-文件的包"><a href="#默认-导入到每个-Kotlin-文件的包" class="headerlink" title="::默认:: 导入到每个 Kotlin 文件的包"></a>::默认:: 导入到每个 Kotlin 文件的包</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> kotlin.*</span><br><span class="line"><span class="keyword">import</span> kotlin.<span class="keyword">annotation</span>.*</span><br><span class="line"><span class="keyword">import</span> kotlin.collections.*</span><br><span class="line"><span class="keyword">import</span> kotlin.comparisons.*</span><br><span class="line"><span class="keyword">import</span> kotlin.io.*</span><br><span class="line"><span class="keyword">import</span> kotlin.ranges.*</span><br><span class="line"><span class="keyword">import</span> kotlin.sequences.*</span><br><span class="line"><span class="keyword">import</span> kotlin.text.*</span><br><span class="line"></span><br><span class="line"><span class="comment">/* if target jvm */</span></span><br><span class="line"><span class="keyword">import</span> java.lang.*</span><br><span class="line"><span class="keyword">import</span> kotlin.jvm.*</span><br><span class="line"></span><br><span class="line"><span class="comment">/* if target js */</span></span><br><span class="line"><span class="keyword">import</span> kotlin.js.*</span><br></pre></td></tr></table></figure>

<h3 id="Kotlin-的代码结构"><a href="#Kotlin-的代码结构" class="headerlink" title="Kotlin 的代码结构"></a>Kotlin 的代码结构</h3><p>不同于 Java；Kotlin 函数是一等公民；可以在文件内（TOP Level）定义变量、函数、匿名函数、类、object 、data 类、enum 类、Sealed Class、Extensions等</p>
<ul>
<li>Kotlin 是大小写敏感的</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cn.yalda.main</span><br><span class="line"><span class="keyword">import</span> java.util.*</span><br><span class="line"></span><br><span class="line"><span class="comment">// cn.yalda.main.test</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">test</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// cn.yalda.main.Text</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> a: <span class="built_in">Int</span> = <span class="number">123</span></span><br><span class="line"><span class="keyword">val</span> sumLambda: (<span class="built_in">Int</span>, <span class="built_in">Int</span>) -&gt; <span class="built_in">Int</span> = &#123; x, y -&gt; x + y &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span>: <span class="built_in">Unit</span> &#123;&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="函数的定义和类型声明"><a href="#函数的定义和类型声明" class="headerlink" title="函数的定义和类型声明"></a>函数的定义和类型声明</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">sum</span><span class="params">(a: <span class="type">Int</span>, b: <span class="type">Int</span>)</span></span>: <span class="built_in">Int</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> a + b</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 返回类型自动推断（函数单一表达式）</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">sum</span><span class="params">(a: <span class="type">Int</span>, b: <span class="type">Int</span>)</span></span> = a + b <span class="comment">// single expression</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 无返回值，声明 Unit 类型（类似 Java 和 TS 的 void）</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">printSum</span><span class="params">(a: <span class="type">Int</span>, b: <span class="type">Int</span>)</span></span>: <span class="built_in">Unit</span> &#123;</span><br><span class="line">	println(a + b)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// public 必须明确声明返回值类型</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">fun</span> <span class="title">sum</span><span class="params">(a: <span class="type">Int</span>, b: <span class="type">Int</span>)</span></span>: <span class="built_in">Int</span> = a + b</span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回值是 Unit 类型，则可以省略</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">fun</span> <span class="title">printSum</span><span class="params">(a: <span class="type">Int</span>, b: <span class="type">Int</span>)</span></span> &#123;</span><br><span class="line">	print(a + b)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="函数的调用"><a href="#函数的调用" class="headerlink" title="函数的调用"></a>函数的调用</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">sum</span><span class="params">(a: <span class="type">Int</span>, b: <span class="type">Int</span>, c: <span class="type">Int</span>)</span></span>:<span class="built_in">Int</span> &#123;</span><br><span class="line">	println(<span class="string">&quot;a = <span class="variable">$a</span>,b =  <span class="variable">$b</span>,c = <span class="variable">$c</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> a + b + c</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sum(<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>) <span class="comment">// a = 0, b = 1, c = 2</span></span><br><span class="line">sum(a = <span class="number">0</span>, b = <span class="number">1</span>, <span class="number">2</span>) <span class="comment">// a = 0, b = 1, c = 2</span></span><br><span class="line">sum(a = <span class="number">0</span>, <span class="number">1</span>, c = <span class="number">2</span>) <span class="comment">// a = 0, b = 1, c = 2</span></span><br><span class="line">sum(<span class="number">0</span>, b = <span class="number">1</span>, c = <span class="number">2</span>) <span class="comment">// a = 0, b = 1, c = 2</span></span><br><span class="line">sum(c = <span class="number">2</span>, b = <span class="number">1</span>, a = <span class="number">0</span>) <span class="comment">// a = 0, b = 1, c = 2</span></span><br><span class="line">sum(c = <span class="number">0</span>, b = <span class="number">1</span>, <span class="number">2</span>) <span class="comment">// Error</span></span><br></pre></td></tr></table></figure>

<h3 id="操作符"><a href="#操作符" class="headerlink" title=":: 操作符"></a>:: 操作符</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>(<span class="keyword">val</span> nickName: String) &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">foo</span><span class="params">(a: <span class="type">Int</span>)</span></span>: <span class="built_in">Int</span> &#123;</span><br><span class="line">        println(<span class="string">&quot;<span class="variable">$a</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">getFun</span><span class="params">(age: <span class="type">Int</span>, function: (<span class="type">Int</span>) -&gt; <span class="type">Int</span>)</span></span> &#123;</span><br><span class="line">        function(age)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> p = Persion(<span class="string">&quot;musk&quot;</span>)</span><br><span class="line">p.getFun(<span class="number">10</span>, p::foo) <span class="comment">// 10</span></span><br></pre></td></tr></table></figure>

<h3 id="可增参数（可变长参数函数）"><a href="#可增参数（可变长参数函数）" class="headerlink" title="可增参数（可变长参数函数）"></a>可增参数（可变长参数函数）</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">vars</span><span class="params">(<span class="keyword">vararg</span> v: <span class="type">Int</span>)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(vi <span class="keyword">in</span> v) println(vi)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vars(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>) <span class="comment">// 1234</span></span><br></pre></td></tr></table></figure>

<h3 id="Lambda（匿名函数-闭包表达式）"><a href="#Lambda（匿名函数-闭包表达式）" class="headerlink" title="Lambda（匿名函数 \ 闭包表达式）"></a>Lambda（匿名函数 \ 闭包表达式）</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123;</span><br><span class="line">	<span class="keyword">val</span> sumLambda: (<span class="built_in">Int</span>, <span class="built_in">Int</span>) -&gt; <span class="built_in">Int</span> = &#123; x, y -&gt; x + y &#125;</span><br><span class="line">	println(sumLambda(<span class="number">1</span>, <span class="number">2</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> sumLambda: (<span class="built_in">Int</span>, <span class="built_in">Int</span>) -&gt; <span class="built_in">Int</span> = &#123; x, y -&gt; x + y &#125;</span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123;</span><br><span class="line">	println(sumLambda(<span class="number">1</span>, <span class="number">2</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Named arguments are not allowed for function types</span></span><br></pre></td></tr></table></figure>

<h3 id="定义常量和变量"><a href="#定义常量和变量" class="headerlink" title="定义常量和变量"></a>定义常量和变量</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 变量 var &lt;标识符&gt;: &lt;类型&gt;&lt;可选&gt; = &lt;初始化知&gt;</span></span><br><span class="line"><span class="keyword">val</span> name: String</span><br><span class="line">name = <span class="string">&quot;xx&quot;</span></span><br><span class="line">name = <span class="string">&quot;yalda&quot;</span> <span class="comment">// Val cannot be reassigned</span></span><br><span class="line"><span class="comment">// 常量与变量都可以没有初始化值,但是在引用前必须初始化</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 常量 val &lt;标识符&gt;: &lt;类型&gt;&lt;可选&gt; = &lt;初始化知&gt;</span></span><br><span class="line"><span class="keyword">var</span> age: <span class="built_in">Int</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">var</span> age1: <span class="built_in">Int</span> <span class="comment">// 声明时未初始化，必须声明类型</span></span><br><span class="line"><span class="keyword">var</span> age = <span class="number">0</span> <span class="comment">// 编译器支持自动类型判断</span></span><br></pre></td></tr></table></figure>

<h3 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// single row command</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	multiple row commands */</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> 	multiple row commands</span></span><br><span class="line"><span class="comment">	<span class="comment">/* kotlin support nest commands*/</span></span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h3 id="字符串模板"><a href="#字符串模板" class="headerlink" title="字符串模板"></a>字符串模板</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">val str: String = &quot;single string&quot;</span><br><span class="line">val temp: String = &quot;$str&quot;</span><br><span class="line">val temp2: Strig = &quot;$str length is $&#123;str.length&#125;&quot;</span><br></pre></td></tr></table></figure>

<h3 id="Null-检查机制"><a href="#Null-检查机制" class="headerlink" title="Null 检查机制"></a>Null 检查机制</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> age: String? = <span class="string">&quot;23&quot;</span> <span class="comment">// ? means optional</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> age = age!!.toInt() <span class="comment">// 23 or null-point-exceptions</span></span><br><span class="line"><span class="keyword">val</span> age1 = age?.toInt() <span class="comment">// 23 or null</span></span><br><span class="line"><span class="keyword">val</span> age2 = age?.toInt() ?: -<span class="number">1</span> <span class="comment">// 23</span></span><br></pre></td></tr></table></figure>

<h3 id="类型检测-自动类型转换"><a href="#类型检测-自动类型转换" class="headerlink" title="类型检测&amp;自动类型转换"></a>类型检测&amp;自动类型转换</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">getStringLength</span><span class="params">(obj: <span class="type">Any</span>)</span></span>: <span class="built_in">Int</span>? &#123;</span><br><span class="line">	<span class="keyword">if</span> (obj <span class="keyword">is</span> String) <span class="keyword">return</span> obj.length</span><br><span class="line">	<span class="keyword">if</span> (obj !<span class="keyword">is</span> String) <span class="keyword">return</span> <span class="literal">null</span> <span class="comment">// or</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (obj <span class="keyword">is</span> String &amp;&amp; obj.length &gt; <span class="number">0</span>) <span class="keyword">return</span> obj.length <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> nulll</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="区间（Range）"><a href="#区间（Range）" class="headerlink" title="区间（Range）"></a>区间（Range）</h3><p>由 <code>..</code> 的 rangeTo 函数 &amp; in &amp; ~!in 形成</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1.</span><span class="number">.4</span>) print(i) <span class="comment">// [1, 4]</span></span><br><span class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1</span> until <span class="number">4</span>) print(n) <span class="comment">// [1, 4)</span></span><br><span class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">4.</span><span class="number">.1</span>) print(i) <span class="comment">//</span></span><br><span class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1.</span><span class="number">.4</span> step <span class="number">2</span>) print(i) <span class="comment">// 13</span></span><br><span class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">4</span> downTo <span class="number">1</span>) print(i) <span class="comment">// 4321</span></span><br></pre></td></tr></table></figure>

<h2 id="基本数据类型"><a href="#基本数据类型" class="headerlink" title="基本数据类型"></a>基本数据类型</h2><h3 id="基本数值"><a href="#基本数值" class="headerlink" title="基本数值"></a>基本数值</h3><p>Byte \ Short \ Int \ Long<br>Float \ Double</p>
<h4 id="字面常量"><a href="#字面常量" class="headerlink" title="字面常量"></a>字面常量</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> oneMillion = <span class="number">1_000_000</span></span><br><span class="line"><span class="keyword">val</span> ID = <span class="number">321023_1999_1212_0000L</span></span><br><span class="line"><span class="keyword">val</span> bigD = <span class="number">123.5e10</span></span><br><span class="line"><span class="keyword">val</span> f= <span class="number">123213f</span> <span class="comment">// 123213F 123213.0</span></span><br><span class="line"><span class="keyword">val</span> hexBytes = <span class="number">0xCCCCCC</span> <span class="comment">// 13421772</span></span><br><span class="line"><span class="keyword">val</span> bytes = <span class="number">0b111111_00000000_111111_000000</span> <span class="comment">// 66064320</span></span><br></pre></td></tr></table></figure>

<h4 id="比较"><a href="#比较" class="headerlink" title="比较"></a>比较</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> a: <span class="built_in">Int</span> = <span class="number">123</span></span><br><span class="line">a == <span class="number">123</span> <span class="comment">// true</span></span><br><span class="line">a === <span class="number">123</span> <span class="comment">// true</span></span><br><span class="line"><span class="keyword">val</span> b: <span class="built_in">Int</span> = <span class="number">123</span></span><br><span class="line">a == b <span class="comment">// true</span></span><br><span class="line">a === b <span class="comment">// true</span></span><br><span class="line"><span class="keyword">val</span> c: <span class="built_in">Int</span>? = a</span><br><span class="line">a == c <span class="comment">// true</span></span><br><span class="line">a === c <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 发现一个有趣的现象</span></span><br><span class="line"><span class="keyword">val</span> a: <span class="built_in">Int</span> = <span class="number">127</span></span><br><span class="line"><span class="keyword">val</span> c: <span class="built_in">Int</span>? = a</span><br><span class="line"><span class="keyword">val</span> d: <span class="built_in">Int</span>? = a</span><br><span class="line">c === d <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> b: <span class="built_in">Int</span> = <span class="number">128</span></span><br><span class="line"><span class="keyword">val</span> c1: <span class="built_in">Int</span>? = b</span><br><span class="line"><span class="keyword">val</span> d1: <span class="built_in">Int</span>? = b</span><br><span class="line">c1 === d1 <span class="comment">// false</span></span><br><span class="line"><span class="comment">// 个人怀疑，kotlin 对代码做了优化；小于 2^8 时使用数值对象，超过则创建新对象</span></span><br></pre></td></tr></table></figure>

<h4 id="类型转换"><a href="#类型转换" class="headerlink" title="类型转换"></a>类型转换</h4><ul>
<li>较小的类型不是较大类型的子类型；在不进行显式转换下是违法的</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> b: <span class="built_in">Byte</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">val</span> i: <span class="built_in">Int</span> = b <span class="comment">// error</span></span><br><span class="line"><span class="keyword">val</span> i: <span class="built_in">Int</span> = b.toInt()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 有些情况会做自动类型转化</span></span><br><span class="line"><span class="keyword">val</span> l = <span class="number">1L</span> + <span class="number">3</span> <span class="comment">// Long + Int -&gt; Long</span></span><br></pre></td></tr></table></figure>

<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">toByte(): <span class="built_in">Byte</span></span><br><span class="line">toShort(): <span class="built_in">Short</span></span><br><span class="line">toInt(): <span class="built_in">Int</span></span><br><span class="line">toLong(): <span class="built_in">Long</span></span><br><span class="line">toFloat(): <span class="built_in">Float</span></span><br><span class="line">toDouble(): <span class="built_in">Double</span></span><br><span class="line">toChar(): <span class="built_in">Char</span></span><br></pre></td></tr></table></figure>

<h4 id="位操作符"><a href="#位操作符" class="headerlink" title="位操作符"></a>位操作符</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">shl <span class="comment">// &lt;&lt; ; 8 shl 1 == 16</span></span><br><span class="line">shr <span class="comment">// &gt;&gt; ; 8 shr 1 == 4</span></span><br><span class="line">ushr <span class="comment">// &gt;&gt;&gt;</span></span><br><span class="line">and <span class="comment">// &amp;</span></span><br><span class="line">or <span class="comment">// |</span></span><br><span class="line">xor <span class="comment">// ^</span></span><br><span class="line">inv <span class="comment">// 反向</span></span><br></pre></td></tr></table></figure>

<h3 id="字符"><a href="#字符" class="headerlink" title="字符"></a>字符</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> c: <span class="built_in">Char</span> = <span class="string">&#x27;c&#x27;</span> <span class="comment">// 必须是单引号</span></span><br><span class="line"><span class="keyword">val</span> c: <span class="built_in">Char</span> = <span class="string">&#x27;\u2354&#x27;</span> <span class="comment">// \t \n \b \r \&#x27; \&quot; \\ \$</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(c !<span class="keyword">in</span> <span class="string">&#x27;0&#x27;</span>..<span class="string">&#x27;9&#x27;</span>) <span class="comment">// range</span></span><br></pre></td></tr></table></figure>

<h3 id="布尔-Boolean"><a href="#布尔-Boolean" class="headerlink" title="布尔 Boolean"></a>布尔 Boolean</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> b: <span class="built_in">Boolean</span> = <span class="literal">false</span> <span class="comment">// false or true</span></span><br><span class="line"><span class="literal">false</span> || <span class="literal">true</span> <span class="comment">// true</span></span><br><span class="line"><span class="literal">false</span> &amp;&amp; <span class="literal">true</span> <span class="comment">// false</span></span><br><span class="line">!<span class="literal">false</span> <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<h3 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h3><p>由类 Array 实现，拥有 size \ get \ set 方法；Kotlin 中的数组是不协变的（invariant）；<br>创建方式：1、arrayOf() 2、工厂函数</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// [1,2,3] arrayOf 函数</span></span><br><span class="line"><span class="keyword">val</span> a = arrayOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">a[<span class="number">0</span>]</span><br><span class="line">a[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// [2,4,6] array 工厂函数</span></span><br><span class="line"><span class="keyword">val</span> a1: Array = Array(<span class="number">3</span>, &#123; x -&gt; x * <span class="number">2</span> &#125;)</span><br><span class="line"><span class="keyword">val</span> ia: IntArray = intArrayOf(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line"><span class="keyword">val</span> ba: ByteArray = byteArrayOf(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line"><span class="keyword">val</span> sa: ShortArray = shortArrayOf(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<h3 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h3><p>同 Java 一样 String 是不可变的</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (c <span class="keyword">in</span> <span class="string">&quot;str&quot;</span>) println(c)</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> text = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">	  |multiple str1</span></span><br><span class="line"><span class="string">    |multiple str2</span></span><br><span class="line"><span class="string">    |multiple str3</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">text <span class="comment">// some pre space(include |)</span></span><br><span class="line">text.trimMargin() <span class="comment">// default use | for replace pre space</span></span><br><span class="line">text.trimMargin(<span class="string">&quot;&gt;&quot;</span>) <span class="comment">// use &gt; for replace pre space</span></span><br></pre></td></tr></table></figure>

<h3 id="字符串模板-1"><a href="#字符串模板-1" class="headerlink" title="字符串模板"></a>字符串模板</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> i = <span class="string">&quot;10&quot;</span></span><br><span class="line"><span class="keyword">val</span> s = <span class="string">&quot;len = <span class="subst">$&#123;i.length&#125;</span>&quot;</span> <span class="comment">// len = 2</span></span><br><span class="line"><span class="keyword">val</span> ms = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">	|price is $<span class="variable">$i</span></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span> <span class="comment">// price is $10</span></span><br></pre></td></tr></table></figure>

<h2 id="条件控制"><a href="#条件控制" class="headerlink" title="条件控制"></a>条件控制</h2><p>Kotlin 里的 <code>if</code> 和 <code>when</code> 均可以作为条件控制语句，也可以作为表达式</p>
<h3 id="IF-表达式"><a href="#IF-表达式" class="headerlink" title="IF 表达式"></a>IF 表达式</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// condition is a statement return Boolean; ex. i in 1..8</span></span><br><span class="line"><span class="keyword">if</span> (condition) ..</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> max = a</span><br><span class="line"><span class="keyword">if</span> (a &lt; b) max = b</span><br><span class="line"><span class="keyword">if</span> (a &lt; b) max = <span class="number">2</span> <span class="keyword">else</span> max = <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> (a &lt; b) &#123;</span><br><span class="line">	max = b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 作为表达式返回结果</span></span><br><span class="line"><span class="keyword">val</span> max = <span class="keyword">if</span> (a &gt; b) a <span class="keyword">else</span> b <span class="comment">// Kotlin 没有三元表达式</span></span><br><span class="line"><span class="keyword">val</span> max = <span class="keyword">if</span> (a &gt; b) &#123;</span><br><span class="line">	println(<span class="string">&quot;Choose a value&quot;</span>)</span><br><span class="line">	a</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">	println(<span class="string">&quot;<span class="variable">$b</span>&quot;</span>)</span><br><span class="line">	b</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="When-表达式"><a href="#When-表达式" class="headerlink" title="When 表达式"></a>When 表达式</h3><p>类似于 C &amp; Java 的 switch 语句</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 作为表达式使用时，符合的分支的值就是表达式的值</span></span><br><span class="line"><span class="comment">// 也可以作为语句（条件控制语句）使用</span></span><br><span class="line"><span class="keyword">when</span> (x) &#123;</span><br><span class="line">	<span class="number">1</span> -&gt; println(<span class="string">&quot;11&quot;</span>)</span><br><span class="line">	<span class="number">2</span> -&gt; println(<span class="string">&quot;22&quot;</span>)</span><br><span class="line">	<span class="number">3</span>, <span class="number">4</span> -&gt; println(<span class="string">&quot;3344&quot;</span>)</span><br><span class="line">	<span class="keyword">in</span> <span class="number">5.</span><span class="number">.10</span> -&gt; println(<span class="string">&quot;5 to 10&quot;</span>)</span><br><span class="line">	!<span class="keyword">in</span> <span class="number">11.</span><span class="number">.20</span> -&gt; println(<span class="string">&quot;no in 11 to 20&quot;</span>)</span><br><span class="line">	<span class="keyword">else</span> -&gt; &#123;</span><br><span class="line">		println(<span class="string">&quot;default&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// use is or !is</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">hasPrefix</span><span class="params">(x: <span class="type">Any</span>)</span></span> = <span class="keyword">when</span>(x) &#123;</span><br><span class="line">	<span class="comment">// Any 是 Kotlin 所有类的基类</span></span><br><span class="line">	<span class="keyword">is</span> String -&gt; println(<span class="string">&quot;is String&quot;</span>)</span><br><span class="line">	<span class="keyword">is</span> <span class="built_in">Int</span> -&gt; println(<span class="string">&quot;is Int&quot;</span>)</span><br><span class="line">	<span class="keyword">else</span> -&gt; &#123;</span><br><span class="line">		println(<span class="string">&quot;else&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// replace if-elseif chain</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> String.<span class="title">isInTen</span><span class="params">()</span></span> = <span class="keyword">this</span> <span class="keyword">in</span> <span class="string">&quot;1&quot;</span>..<span class="string">&quot;10&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> String.<span class="title">isInHundred</span><span class="params">()</span></span> = <span class="keyword">this</span> <span class="keyword">in</span> <span class="string">&quot;1&quot;</span>..<span class="string">&quot;100&quot;</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="string">&quot;50&quot;</span></span><br><span class="line"><span class="keyword">when</span> &#123;</span><br><span class="line">	a.isInTen() -&gt; println(<span class="string">&quot;a in [1, 10]&quot;</span>)</span><br><span class="line">	a.isInHundred() -&gt; println(<span class="string">&quot;a in [1, 100]&quot;</span>)</span><br><span class="line">	<span class="keyword">else</span> -&gt; println(<span class="string">&quot;a not in range&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// use in</span></span><br><span class="line"><span class="keyword">val</span> items = setOf(<span class="string">&quot;apple&quot;</span>, <span class="string">&quot;huawei&quot;</span>)</span><br><span class="line"><span class="keyword">when</span> &#123;</span><br><span class="line">	<span class="string">&quot;xiaomi&quot;</span> <span class="keyword">in</span> items -&gt; println(<span class="string">&quot;mi&quot;</span>)</span><br><span class="line">	<span class="string">&quot;vivo&quot;</span> <span class="keyword">in</span> items -&gt; println(<span class="string">&quot;mi&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="循环控制"><a href="#循环控制" class="headerlink" title="循环控制"></a>循环控制</h2><h3 id="for-循环"><a href="#for-循环" class="headerlink" title="for 循环"></a>for 循环</h3><p>对提供迭代器的对象进行遍历：<code>for (item in collection) statement</code></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// array &amp; array.indices &amp; array.withIndex()</span></span><br><span class="line"><span class="keyword">for</span> (v <span class="keyword">in</span> arrayOf(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)) print(v)  <span class="comment">// 123</span></span><br><span class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> arrayOf(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>).indices) print(i) <span class="comment">// 012</span></span><br><span class="line"><span class="keyword">for</span> (v <span class="keyword">in</span> Array(<span class="number">3</span>, &#123; x -&gt; x * <span class="number">2</span> &#125;)) print(v) <span class="comment">// 024</span></span><br><span class="line"><span class="keyword">for</span> ((i,v) <span class="keyword">in</span> arrayOf(<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>).withIndex()) println(<span class="string">&quot;<span class="variable">$i</span> <span class="variable">$v</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// list &amp; &amp; list.indices list.withIndex()</span></span><br><span class="line"><span class="keyword">for</span> (v <span class="keyword">in</span> listOf(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)) print(v) <span class="comment">// 123</span></span><br><span class="line"><span class="keyword">for</span>(i <span class="keyword">in</span> listOf(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>).indices) print(<span class="string">&quot;<span class="variable">$i</span>&quot;</span>) <span class="comment">// 012</span></span><br><span class="line"><span class="keyword">for</span> ((index, value) <span class="keyword">in</span> listOf(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>).withIndex()) println(v)</span><br><span class="line"></span><br><span class="line"><span class="comment">// set &amp; set.withIndex()</span></span><br><span class="line"><span class="keyword">for</span> (v <span class="keyword">in</span> setOf(<span class="string">&quot;aa&quot;</span>, <span class="string">&quot;bb&quot;</span>)) println(<span class="string">&quot;<span class="variable">$v</span>&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> ((i, v) <span class="keyword">in</span> setOf(<span class="string">&quot;aa&quot;</span>, <span class="string">&quot;bb&quot;</span>).withIndex()) println(<span class="string">&quot;<span class="variable">$i</span> <span class="variable">$v</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// map &amp; map destruct</span></span><br><span class="line"><span class="keyword">for</span> (v <span class="keyword">in</span> mapOf(<span class="string">&quot;a&quot;</span> to <span class="string">&quot;xx&quot;</span>, <span class="string">&quot;b&quot;</span> to <span class="string">&quot;yy&quot;</span>)) println(v) <span class="comment">// a=xx \n b =yy</span></span><br><span class="line"><span class="keyword">for</span> ((k, v) <span class="keyword">in</span> mapOf(<span class="string">&quot;a&quot;</span> to <span class="string">&quot;xx&quot;</span>, <span class="string">&quot;b&quot;</span> to <span class="string">&quot;yy&quot;</span>)) println(<span class="string">&quot;<span class="variable">$k</span> <span class="variable">$v</span>&quot;</span>) <span class="comment">// a xx \n b yy</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// range</span></span><br><span class="line"><span class="keyword">for</span> (v <span class="keyword">in</span> <span class="number">1.</span><span class="number">.10</span>) print(<span class="string">&quot;<span class="variable">$v</span>&quot;</span>) <span class="comment">// 12345678910</span></span><br><span class="line"><span class="keyword">for</span> (v <span class="keyword">in</span> <span class="number">1</span> until <span class="number">10</span>) print(v) <span class="comment">// 123456789</span></span><br><span class="line"><span class="keyword">for</span> (v <span class="keyword">in</span> <span class="number">1.</span><span class="number">.10</span> step <span class="number">2</span>) print(v) <span class="comment">// 13579</span></span><br><span class="line"><span class="keyword">for</span> (v <span class="keyword">in</span> <span class="number">10</span> downTo <span class="number">1</span>) print(v) <span class="comment">// 10987654321</span></span><br></pre></td></tr></table></figure>

<h3 id="while-do…while-循环"><a href="#while-do…while-循环" class="headerlink" title="while &amp; do…while 循环"></a>while &amp; do…while 循环</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> ( <span class="comment">/* Boolean expression */</span>) &#123;&#125;</span><br><span class="line"><span class="keyword">do</span> &#123; <span class="comment">/* logic */</span> &#125; <span class="keyword">while</span> ( <span class="comment">/* Boolean expression */</span>)</span><br></pre></td></tr></table></figure>

<h3 id="返回和跳转"><a href="#返回和跳转" class="headerlink" title="返回和跳转"></a>返回和跳转</h3><ul>
<li>return 从循环体的包装函数 &amp; Lambda 返回</li>
<li>break 终止循环体</li>
<li>continue 跳出本次循环，进入下一次循环</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(i &lt; <span class="number">10</span>) &#123;</span><br><span class="line">	i += <span class="number">1</span></span><br><span class="line">  <span class="keyword">if</span> (i == <span class="number">2</span>) <span class="keyword">continue</span></span><br><span class="line">	<span class="keyword">if</span> (i ==<span class="number">5</span> ) <span class="keyword">break</span></span><br><span class="line">  print(i)</span><br><span class="line">&#125; <span class="comment">// 134</span></span><br></pre></td></tr></table></figure>

<h3 id="Break-Continue-Label"><a href="#Break-Continue-Label" class="headerlink" title="Break &amp; Continue &amp; Label"></a>Break &amp; Continue &amp; Label</h3><p>任何表达式都可以使用标签（label@）来标记</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">myloop@</span> <span class="keyword">for</span>(i <span class="keyword">in</span> <span class="number">1.</span><span class="number">.10</span>) &#123;</span><br><span class="line">	<span class="keyword">if</span>(i == <span class="number">3</span>) <span class="keyword">break</span><span class="symbol">@myloop</span></span><br><span class="line">	print(i)</span><br><span class="line">&#125; <span class="comment">// 12</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123;</span><br><span class="line">	<span class="keyword">val</span> ints = listOf(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>)</span><br><span class="line">	ints.forEach &#123;</span><br><span class="line">        <span class="keyword">if</span>(it == <span class="number">2</span>) <span class="keyword">return</span></span><br><span class="line">        print(it)</span><br><span class="line">	&#125; <span class="comment">// 1 (直接从 main 函数返回)</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 给 forEach 添加 label；return 到 forEach 函数（如不加，则直接从 main 函数返回）</span></span><br><span class="line">	ints.forEach <span class="symbol">lit@</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(it == <span class="number">2</span>) <span class="keyword">return</span><span class="symbol">@lit</span></span><br><span class="line">        print(it)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 等效；Lambda 表达式（隐式标签，与 lambda 函数同名）</span></span><br><span class="line">	ints.forEach &#123;</span><br><span class="line">		<span class="keyword">if</span>(it == <span class="number">2</span>) <span class="keyword">return</span><span class="symbol">@forEach</span></span><br><span class="line">		print(it)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 等效；使用匿名函数替代 lambda 表达式</span></span><br><span class="line">	ints.forEach(<span class="function"><span class="title">fun</span><span class="params">(value: <span class="type">Int</span>)</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(value == <span class="number">2</span>) <span class="keyword">return</span></span><br><span class="line">		print(it)</span><br><span class="line">	&#125;)</span><br><span class="line">&#125; <span class="comment">// 1345</span></span><br></pre></td></tr></table></figure>

<h2 id="类和对象"><a href="#类和对象" class="headerlink" title="类和对象"></a>类和对象</h2><h3 id="类的结构-声明"><a href="#类的结构-声明" class="headerlink" title="类的结构 &amp; 声明"></a>类的结构 &amp; 声明</h3><p>Kotlin 类包含：构造函数、初始化代码块、内部类、函数、属性、对象声明</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">EmptyClass</span> // 空类</span><br><span class="line"><span class="keyword">val</span> e = EmptyClass() <span class="comment">// 实例化时无需 new 关键字</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Demo</span> &#123;</span><br><span class="line">	<span class="keyword">val</span> name: String? = <span class="string">&quot;yalda&quot;</span> <span class="comment">// 属性（成员变量）</span></span><br><span class="line">	<span class="keyword">val</span> website: String? = <span class="string">&quot;yalda.cn&quot;</span> <span class="comment">// 属性（成员变量）</span></span><br><span class="line">	<span class="function"><span class="keyword">fun</span> <span class="title">foo</span><span class="params">()</span></span> = print(<span class="string">&quot;<span class="subst">$&#123;this.website&#125;</span>&quot;</span>) <span class="comment">// 函数（成员方法）</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">val</span> d = Demo()</span><br><span class="line">d.name <span class="comment">// yalda access property name</span></span><br><span class="line">d.foo() <span class="comment">// yalda.cn access &amp; run foo method</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 主构造器以及一个或多个次构造器；主构造器写在类头部（类名后）</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> <span class="keyword">constructor</span>(firstName: String) &#123;&#125;</span><br><span class="line"><span class="comment">// 如果构造器没有注解、以及修饰符可省略 constructor 关键字</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>(firstName: String) &#123;&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span> (<span class="keyword">val</span> nickName: String) &#123;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Getter-Setter"><a href="#Getter-Setter" class="headerlink" title="Getter &amp; Setter"></a>Getter &amp; Setter</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> &lt;propertyName&gt;[: &lt;PropertyType&gt;] [= &lt;initializer&gt;]</span><br><span class="line">	[&lt;getter&gt;]</span><br><span class="line">	[&lt;setter&gt;]</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> name: String = <span class="string">&quot;&quot;</span> <span class="comment">// 实现 getter &amp; setter</span></span><br><span class="line"><span class="keyword">val</span> name: String <span class="comment">// Error, getter &amp; must init in constructor</span></span><br><span class="line"><span class="keyword">val</span> name: String = <span class="string">&quot;&quot;</span> <span class="comment">// 实现 getter</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">	<span class="keyword">var</span> name: String? = <span class="string">&quot;yalda&quot;</span></span><br><span class="line">    	<span class="keyword">get</span>() = field!!.toUpperCase()</span><br><span class="line">      <span class="keyword">set</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> site: String? = <span class="string">&quot;&quot;</span></span><br><span class="line">	    <span class="keyword">get</span>() = field <span class="comment">// equals get or no defined</span></span><br><span class="line">		<span class="keyword">set</span>(s) &#123;</span><br><span class="line">			field = <span class="string">&quot;https://<span class="variable">$s</span>&quot;</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> heiht: <span class="built_in">Float</span> = <span class="number">145.0f</span></span><br><span class="line">    	<span class="keyword">get</span></span><br><span class="line">    	<span class="keyword">private</span> <span class="keyword">set</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Late-init"><a href="#Late-init" class="headerlink" title="Late init"></a>Late init</h3><p>非空属性必须在定义时初始化；延迟初始化需要用到 <code>lateinit</code> 关键字</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyTest</span> &#123;</span><br><span class="line">	<span class="keyword">lateinit</span> <span class="keyword">var</span> subject: TestSubject</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Setup</span> <span class="function"><span class="keyword">fun</span> <span class="title">setup</span><span class="params">()</span></span> &#123;</span><br><span class="line">		subject = TextSubject()</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Setup</span> <span class="function"><span class="keyword">fun</span> <span class="title">test</span><span class="params">()</span></span> &#123;</span><br><span class="line">		subject.method()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="主构造器-初始化代码块-实例化"><a href="#主构造器-初始化代码块-实例化" class="headerlink" title="主构造器 &amp; 初始化代码块 &amp; 实例化"></a>主构造器 &amp; 初始化代码块 &amp; 实例化</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> <span class="keyword">constructor</span>(nickName: String) &#123;</span><br><span class="line">	<span class="keyword">init</span> &#123;</span><br><span class="line">		println(nickName)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 简约语法，通过主构造器定义属性和初始化属性值</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>(<span class="keyword">val</span> nickName: String = <span class="string">&quot;jok&quot;</span>)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>(<span class="keyword">val</span> nickName: String = <span class="string">&quot;jok&quot;</span>) &#123;</span><br><span class="line">	<span class="keyword">init</span> &#123;</span><br><span class="line">		println(<span class="string">&quot;nick is <span class="variable">$nickName</span>&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> p = Person(<span class="string">&quot;king&quot;</span>) <span class="comment">// nick is king</span></span><br><span class="line">p.nickName <span class="comment">// king</span></span><br></pre></td></tr></table></figure>

<h3 id="次构造函数"><a href="#次构造函数" class="headerlink" title="次构造函数"></a>次构造函数</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="keyword">constructor</span>(parent: Person) &#123; <span class="comment">// prefix constructor</span></span><br><span class="line">        parent.children.add(<span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果有主构造器，每个次构造器都要（直接或间接）代理主构造器；并使用 this 代理主</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>(<span class="keyword">val</span> nickName: String) &#123;</span><br><span class="line">	<span class="keyword">constructor</span>(name: String, site: String): <span class="keyword">this</span>(name)&#123;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>(<span class="keyword">val</span> nickName: String) &#123;</span><br><span class="line">  <span class="keyword">var</span> site: String = <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="comment">// this(name, site) 代表 主构造器</span></span><br><span class="line">	<span class="keyword">constructor</span>(name: String, site: String): <span class="keyword">this</span>(name)&#123;</span><br><span class="line">		<span class="keyword">this</span>.site = site</span><br><span class="line">		println(<span class="string">&quot;1&gt; name <span class="variable">$name</span>, site <span class="variable">$site</span>&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// this(name, site) 代表 1&gt; 次构造器</span></span><br><span class="line">  <span class="keyword">constructor</span>(name: String, site: String, fields: <span class="built_in">Int</span>): <span class="keyword">this</span>(name, site)&#123;</span><br><span class="line">		println(<span class="string">&quot;2&gt; name <span class="variable">$name</span>, site <span class="variable">$site</span>, fields <span class="variable">$fields</span>&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果构造器参数有默认值，编译器会生成一个附加的无参构造器，这个构造函数会直接使用默认值；从而达到无参构造函数创建实例</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Customer</span>(<span class="keyword">val</span> customerName: String = <span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="抽象类"><a href="#抽象类" class="headerlink" title="抽象类"></a>抽象类</h3><p>抽象是 OOP 的特征之一，采用 <code>abstract</code> 来声明</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 不必对抽象类标注 open</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">	<span class="keyword">abstract</span> <span class="function"><span class="keyword">fun</span> <span class="title">walk</span><span class="params">(distance: <span class="type">Double</span>)</span></span>: <span class="built_in">Unit</span></span><br><span class="line">	<span class="keyword">abstract</span> <span class="function"><span class="keyword">fun</span> <span class="title">step</span><span class="params">()</span></span>: <span class="built_in">Double</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">open</span> <span class="keyword">class</span> <span class="title class_">Base</span> &#123;</span><br><span class="line">	<span class="keyword">open</span> <span class="function"><span class="keyword">fun</span> <span class="title">f</span><span class="params">()</span></span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Derived</span>: <span class="type">Base</span>() &#123;</span><br><span class="line">	<span class="keyword">override</span> <span class="keyword">abstract</span> <span class="function"><span class="keyword">fun</span> <span class="title">f</span><span class="params">()</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="嵌套类"><a href="#嵌套类" class="headerlink" title="嵌套类"></a>嵌套类</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Outer</span> &#123;</span><br><span class="line">	<span class="keyword">val</span> name = <span class="string">&quot;outer name&quot;</span></span><br><span class="line">	<span class="keyword">class</span> <span class="title class_">Inner</span> &#123;</span><br><span class="line">		<span class="keyword">val</span> name = <span class="string">&quot;inner name&quot;</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">Outer().name <span class="comment">// outer name</span></span><br><span class="line">Outer.Inner().name <span class="comment">// inner name</span></span><br></pre></td></tr></table></figure>

<h3 id="内部类"><a href="#内部类" class="headerlink" title="内部类"></a>内部类</h3><p>内部类采用 <code>this@&lt;class-name&gt;</code> 来访问外部类上下文</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Outer</span> &#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">val</span> name = <span class="string">&quot;outer name&quot;</span></span><br><span class="line">  	<span class="keyword">val</span> nickName = <span class="string">&quot;nike man&quot;</span></span><br><span class="line">	<span class="keyword">inner</span> <span class="keyword">class</span> <span class="title class_">Inner</span> &#123;</span><br><span class="line">		<span class="function"><span class="keyword">fun</span> <span class="title">name</span><span class="params">()</span></span> = name <span class="comment">// 可以直接访问外部类成员（包括私有）</span></span><br><span class="line">		<span class="function"><span class="keyword">fun</span> <span class="title">nick</span><span class="params">()</span></span> = nickName</span><br><span class="line">		<span class="function"><span class="keyword">fun</span> <span class="title">foo</span><span class="params">()</span></span>: String &#123;</span><br><span class="line">			<span class="keyword">val</span> cxt = <span class="keyword">this</span><span class="symbol">@Outer</span> <span class="comment">// 外部类引用</span></span><br><span class="line">          <span class="keyword">return</span> cxt.nickName</span><br><span class="line">       &#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">Outer().Inner().name() <span class="comment">// outer name</span></span><br><span class="line">Outer().Inner().nick() <span class="comment">// nike man</span></span><br><span class="line">Outer().Inner().foo() <span class="comment">// nike man</span></span><br></pre></td></tr></table></figure>

<h3 id="匿名内部类"><a href="#匿名内部类" class="headerlink" title="匿名内部类"></a>匿名内部类</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">val</span> v = <span class="string">&quot;viv&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">setInterFace</span><span class="params">(test: <span class="type">TestInterFace</span>)</span></span> &#123;</span><br><span class="line">        test.foo()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">TestInterFace</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">foo</span><span class="params">()</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> test = Test()</span><br><span class="line">test.setInterFace(<span class="keyword">object</span>: TestInterFace &#123;</span><br><span class="line">	<span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">foo</span><span class="params">()</span></span> &#123;</span><br><span class="line">		println(<span class="string">&quot;&gt;&gt;foo print 匿名内部类&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br><span class="line"> <span class="comment">// &gt;&gt;foo print 匿名内部类</span></span><br></pre></td></tr></table></figure>

<h3 id="类修饰符"><a href="#类修饰符" class="headerlink" title="类修饰符"></a>类修饰符</h3><ul>
<li>class modifier<ul>
<li>abstract &#x2F;&#x2F; 抽象类</li>
<li>final &#x2F;&#x2F; 类不可继承，默认属性</li>
<li>enum &#x2F;&#x2F; 枚举类</li>
<li>open &#x2F;&#x2F; 父类（基类、可继承类），类默认 final</li>
<li>annotation 注解类</li>
<li>enum &#x2F;&#x2F; 枚举类</li>
<li>data &#x2F;&#x2F; 数据类</li>
<li>sealed &#x2F;&#x2F; 密封类</li>
</ul>
</li>
<li>visibility modifier<ul>
<li>private &#x2F;&#x2F; 仅同一个文件内可见</li>
<li>protected &#x2F;&#x2F; 同一个文件或者子类可见</li>
<li>public &#x2F;&#x2F; 所有调用方可见</li>
<li>internal &#x2F;&#x2F; 同一个模块可见</li>
</ul>
</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.kt</span></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">foo</span><span class="params">()</span></span> &#123;&#125; <span class="comment">// 文件 mian.kt 内可见</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">var</span>: MAX_LAVEL = <span class="number">24</span> <span class="comment">// 所有调用方均可见</span></span><br><span class="line"><span class="keyword">internal</span> <span class="keyword">val</span> baz = <span class="number">0</span> <span class="comment">// 想通模块内可见</span></span><br></pre></td></tr></table></figure>

<h2 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h2><ul>
<li>Kotlin 所有类都隐式继承 Any 类；Any 类是所有类的超类包含了 <code>equals()</code> <code>hashCode()</code> <code>toString()</code> 三个函数</li>
<li>Any类 不是 java.lang.Object</li>
<li>如果一个类需要可继承需 <code>open</code> 关键字修饰</li>
<li>子类有构造函数，则基类必须要主构造函数立即初始化</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">open</span> <span class="keyword">class</span> <span class="title class_">Response</span>(value: <span class="built_in">Int</span>, msg: String)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ErrRes</span>(value: <span class="built_in">Int</span>, msg: String): Response(value, msg) &#123;</span><br><span class="line">	<span class="keyword">init</span> &#123;</span><br><span class="line">		println(<span class="string">&quot;<span class="variable">$value</span>, <span class="variable">$msg</span>&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">ErrRes(value = <span class="number">500</span>, msg = <span class="string">&quot;server err&quot;</span>) <span class="comment">// 500, server err</span></span><br></pre></td></tr></table></figure>

<h3 id="子类是否有主构造函数"><a href="#子类是否有主构造函数" class="headerlink" title="子类是否有主构造函数"></a>子类是否有主构造函数</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 子类无主构造函数，需要在每个次构造函数中用 super 来初始化基类</span></span><br><span class="line"><span class="comment">// 而基类也可以提供多种构造函数，供子类初始化</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ErrRes</span>: <span class="type">Response</span> &#123;</span><br><span class="line">	<span class="keyword">constructor</span>(): <span class="keyword">super</span>(<span class="number">200</span>, <span class="string">&quot;ok&quot;</span>) &#123;</span><br><span class="line">		println(<span class="string">&quot;200&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">	<span class="keyword">constructor</span>(value: <span class="built_in">Int</span>): <span class="keyword">super</span>(value, <span class="string">&quot;error&quot;</span>) &#123;</span><br><span class="line">   	println(value)</span><br><span class="line">  &#125;</span><br><span class="line">	<span class="keyword">constructor</span>(value: <span class="built_in">Int</span>, msg: String): <span class="keyword">super</span>(value, msg) &#123;</span><br><span class="line">		println(<span class="string">&quot;<span class="variable">$value</span> <span class="variable">$msg</span>&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">constructor</span>(value: <span class="built_in">Int</span>, errorCode: <span class="built_in">Int</span>, msg: String): 	<span class="keyword">super</span>(value,msg) &#123;</span><br><span class="line">		println(<span class="string">&quot;<span class="variable">$value</span> <span class="variable">$errorCode</span> <span class="variable">$msg</span>&quot;</span>)</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="重写-override"><a href="#重写-override" class="headerlink" title="重写 override"></a>重写 override</h3><p>open class 函数默认 final 修饰，如果提供重写能力需添加 <code>open</code> 修饰</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">open</span> <span class="keyword">class</span> <span class="title class_">Response</span> &#123;</span><br><span class="line">	<span class="function"><span class="keyword">fun</span> <span class="title">getErrCode</span><span class="params">()</span></span> &#123;&#125; <span class="comment">// final can not be overrided</span></span><br><span class="line">	<span class="keyword">open</span> <span class="function"><span class="keyword">fun</span> <span class="title">redirect</span><span class="params">()</span></span> &#123;&#125; <span class="comment">// can be overrided</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果有多个相同方法，则必须重写，可使用 <code>super&lt;Type&gt;</code> 选择性调用</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">open</span> <span class="keyword">class</span> <span class="title class_">Response</span> &#123;</span><br><span class="line">	<span class="keyword">open</span> <span class="function"><span class="keyword">fun</span> <span class="title">getCode</span><span class="params">()</span></span>: <span class="built_in">Int</span> &#123;</span><br><span class="line">		println(<span class="string">&quot;response code = 200&quot;</span>)</span><br><span class="line">      <span class="keyword">return</span> <span class="number">200</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IRes</span> &#123;</span><br><span class="line">	<span class="function"><span class="keyword">fun</span> <span class="title">getCode</span><span class="params">()</span></span>: <span class="built_in">Int</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">500</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">HomeRes</span>: <span class="type">Response</span>(), IRes &#123;</span><br><span class="line">	<span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getCode</span><span class="params">()</span></span>: <span class="built_in">Int</span> &#123;</span><br><span class="line">  		<span class="keyword">super</span>&lt;Response&gt;.getCode()</span><br><span class="line">		<span class="keyword">super</span>&lt;IRes&gt;.getCode()</span><br><span class="line">		<span class="keyword">return</span> <span class="number">302</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">HomeRes().getCode() <span class="comment">// 302</span></span><br></pre></td></tr></table></figure>

<h3 id="属性重写-property-override"><a href="#属性重写-property-override" class="headerlink" title="属性重写 property override"></a>属性重写 property override</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Badge</span> &#123;</span><br><span class="line">	<span class="keyword">val</span> count: <span class="built_in">Int</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Game</span>(<span class="keyword">override</span> <span class="keyword">val</span> count: <span class="built_in">Int</span>): Badge</span><br><span class="line">Game(count = <span class="number">1</span>).count <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 可以使用 var 重写 val property; 反之不行</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Game</span>: <span class="type">Badge</span> &#123;</span><br><span class="line">	<span class="keyword">override</span> <span class="keyword">var</span> count: <span class="built_in">Int</span> = <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h2><ul>
<li>Kotlin 接口和 Java 的接口类似</li>
<li>使用 <code>interface</code> 关键字定义</li>
<li>允许有默认实现</li>
</ul>
<h3 id="实现接口"><a href="#实现接口" class="headerlink" title="实现接口"></a>实现接口</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">MyInterface</span> &#123;</span><br><span class="line">	<span class="function"><span class="keyword">fun</span> <span class="title">boo</span><span class="params">()</span></span> <span class="comment">// 未实现，抽象方法</span></span><br><span class="line">	<span class="function"><span class="keyword">fun</span> <span class="title">foo</span><span class="params">()</span></span>: String &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;interface foo&quot;</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span>: <span class="type">MyInterface</span> &#123;</span><br><span class="line">	<span class="comment">// 未实现的接口函数，必须实现</span></span><br><span class="line">	<span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">boo</span><span class="params">()</span></span> = println(<span class="string">&quot;class boo&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass1</span>: <span class="type">MyInterface</span> &#123;</span><br><span class="line">	<span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">boo</span><span class="params">()</span></span> = println(<span class="string">&quot;class1 boo&quot;</span>)</span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">foo</span><span class="params">()</span></span> = <span class="string">&quot;class1 foo&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="接口中的属性"><a href="#接口中的属性" class="headerlink" title="接口中的属性"></a>接口中的属性</h3><p>接口的属性只能是抽象的，不允许初始化值；实现接口必须重写属性</p>
<h3 id="函数重写"><a href="#函数重写" class="headerlink" title="函数重写"></a>函数重写</h3><p>继承多个接口时， 实现类可以通过 <code>super&lt;Interface&gt;</code> 来选择性调用接口函数（未实现的抽象方法可以忽略）</p>
<h2 id="扩展"><a href="#扩展" class="headerlink" title="扩展"></a>扩展</h2><ul>
<li>Kotlin 可以对一个类（属性、方法）进行扩展且不需要继承或者装饰器模式（Decorator）</li>
<li>扩展是一种静态行为</li>
<li>对被扩展的类代码本身不会造成任何影响（有点类似 JS 的 Reflect）</li>
</ul>
<h3 id="扩展函数"><a href="#扩展函数" class="headerlink" title="扩展函数"></a>扩展函数</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// receiverType 函数的扩展对象</span></span><br><span class="line"><span class="comment">// functionName 扩展函数名</span></span><br><span class="line"><span class="comment">// params 参数 or NULL</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> receiverType.<span class="title">functionName</span><span class="params">(params)</span></span> &#123;</span><br><span class="line">	<span class="comment">/* body */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Kotlin 内置对象</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> String.<span class="title">trimLength</span><span class="params">()</span></span>: <span class="built_in">Int</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">this</span>.trim().length</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">&quot;   ccc&quot;</span>.trimLength() <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// custom class</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>(<span class="keyword">var</span> name: String)</span><br><span class="line"><span class="function"><span class="keyword">fun</span> User.<span class="title">nickName</span><span class="params">()</span></span> = <span class="string">&quot;taylor <span class="subst">$&#123;this.name&#125;</span>&quot;</span></span><br><span class="line">User(name = <span class="string">&quot;swift&quot;</span>).nickName() <span class="comment">// taylor swift</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Kotlin 集合对象</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> MutableList<span class="type">&lt;Int&gt;</span>.<span class="title">replaceItem</span><span class="params">(pre: <span class="type">Int</span>, post: <span class="type">Int</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> tmp = <span class="keyword">this</span>[pre]</span><br><span class="line">    <span class="keyword">this</span>[pre] = <span class="keyword">this</span>[post]</span><br><span class="line">    <span class="keyword">this</span>[post] = tmp</span><br><span class="line">&#125;</span><br><span class="line">mutableListOf(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>).replaceItem(<span class="number">0</span>, <span class="number">2</span>) <span class="comment">// [3,2,1]</span></span><br></pre></td></tr></table></figure>

<h3 id="扩展函数-扩展属性"><a href="#扩展函数-扩展属性" class="headerlink" title="扩展函数 &amp; 扩展属性"></a>扩展函数 &amp; 扩展属性</h3><ul>
<li><strong>扩展函数是静态解析，不是接收者类型的虚拟成员</strong></li>
<li>扩展函数和成员函数一致时，优先使用成员函数</li>
<li>扩展属性允许定义在类和 Kotlin 文件中，但是不允许在函数中定义</li>
<li>只能显示定义 getter &#x2F; setter，所以不允许被初始化</li>
<li>扩展属性只能被声明为 <code>val</code></li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 扩展空对象</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> Any?.<span class="title">toString</span><span class="params">()</span></span>: String &#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">this</span> == <span class="literal">null</span>) <span class="keyword">return</span> <span class="string">&quot;nil&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&gt;&gt; <span class="subst">$&#123;this.toString()&#125;</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>?.toString() <span class="comment">// 1 优先使用成员函数</span></span><br><span class="line"><span class="literal">null</span>.toString() <span class="comment">// null</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 扩展属性</span></span><br><span class="line"><span class="keyword">val</span> &lt;T&gt; List&lt;T&gt;.lastIndex: <span class="built_in">Int</span></span><br><span class="line">	<span class="keyword">get</span>() = site - <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 初始化</span></span><br><span class="line"><span class="keyword">val</span> Foo.<span class="keyword">var</span> = <span class="number">1</span> <span class="comment">// Error 初始化属性没有后端字段（backing field）</span></span><br></pre></td></tr></table></figure>

<h3 id="伴生对象的扩展"><a href="#伴生对象的扩展" class="headerlink" title="伴生对象的扩展"></a>伴生对象的扩展</h3><ul>
<li>伴生对象内的成员相当于 Java 中的静态成员，其生命周期伴随类始终</li>
<li>伴生对象内的成员和函数可以直接用类名引用</li>
<li>伴生对象扩展分为：类内扩展 和 类外扩展<ul>
<li>两者（可以同名）互不影响</li>
<li>类外扩展的伴生对象函数可以被伴生对象内的函数引用</li>
</ul>
</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line">	<span class="keyword">companion</span> <span class="keyword">object</span> &#123; <span class="comment">// MyClass 伴生对象</span></span><br><span class="line">		<span class="keyword">val</span> field1 = <span class="number">1</span> <span class="comment">// 类内伴生对象类成员</span></span><br><span class="line">		<span class="keyword">val</span> field2 = <span class="string">&quot;field2&quot;</span> <span class="comment">// 类内伴生对象类成员</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">// 类内伴生对象函数 cFun</span></span><br><span class="line">		<span class="function"><span class="keyword">fun</span> <span class="title">cFun</span><span class="params">()</span></span> &#123;</span><br><span class="line">			println(<span class="string">&quot;companion cfun&quot;</span>)</span><br><span class="line">			foo() <span class="comment">// 伴生对象可以引用，类外扩展的伴生对象</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">fun</span> <span class="title">cFun2</span><span class="params">()</span></span> &#123;</span><br><span class="line">			println(<span class="string">&quot;companion cfun2&quot;</span>)</span><br><span class="line">			cFun() <span class="comment">//</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 类内扩展</span></span><br><span class="line">	<span class="function"><span class="keyword">fun</span> MyClass.Companion.<span class="title">foo</span><span class="params">()</span></span> = println(<span class="string">&quot;伴生对象类内扩展函数&quot;</span>)</span><br><span class="line">	<span class="function"><span class="keyword">fun</span> <span class="title">test</span><span class="params">()</span></span> &#123;</span><br><span class="line">		MyClass.foo()</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">init</span> &#123;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="扩展的作用域"><a href="#扩展的作用域" class="headerlink" title="扩展的作用域"></a>扩展的作用域</h3><ul>
<li>函数扩展和属性定义在顶级包下 <code>package cn.yalda</code></li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// cn/yalda/main.kt</span></span><br><span class="line"><span class="keyword">package</span> cn.yalda</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> Yalda.<span class="title">foo</span><span class="params">()</span></span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// cn/yalda/models/home</span></span><br><span class="line"><span class="keyword">package</span> cn.yalda.models.home</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.yalda.foo <span class="comment">// or import cn.yalda.*</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> y: Yalda = Yalda()</span><br><span class="line">y.foo() <span class="comment">// ...</span></span><br></pre></td></tr></table></figure>

<h3 id="扩展声明为成员"><a href="#扩展声明为成员" class="headerlink" title="扩展声明为成员"></a>扩展声明为成员</h3><ul>
<li>在一个类（分发接受者）内部可以为另一个类（扩展接受者）声明扩展</li>
<li>假如某个函数，分发接收者和扩展接收者均存在，扩展接收者优先；</li>
<li>可以使用 <code>this</code> 关键字类使用分发接受者函数</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">	<span class="function"><span class="keyword">fun</span> <span class="title">study</span><span class="params">()</span></span> = println(<span class="string">&quot;day day up&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Classmeta</span> &#123;</span><br><span class="line">	<span class="function"><span class="keyword">fun</span> <span class="title">study</span><span class="params">()</span></span> = println(<span class="string">&quot;meta study&quot;</span>)</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">fun</span> Student.<span class="title">learn</span><span class="params">()</span></span> &#123;</span><br><span class="line">		study() <span class="comment">// class Student(扩展接受者优先)</span></span><br><span class="line">		<span class="keyword">this</span><span class="symbol">@Classmeta</span>.study() <span class="comment">// Classmeta.study</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">fun</span> <span class="title">caller</span><span class="params">(s: <span class="type">Student</span>)</span></span> = s.learn()</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">val</span> s = Student()</span><br><span class="line"><span class="keyword">val</span> m = Classmeta()</span><br><span class="line">m.caller(s) <span class="comment">// day day up \n meta study</span></span><br></pre></td></tr></table></figure>

<h2 id="数据类-密封类-枚举类"><a href="#数据类-密封类-枚举类" class="headerlink" title="数据类 &amp; 密封类 &amp; 枚举类"></a>数据类 &amp; 密封类 &amp; 枚举类</h2><h3 id="数据类定义-复制-实例化"><a href="#数据类定义-复制-实例化" class="headerlink" title="数据类定义 &amp; 复制 &amp; 实例化"></a>数据类定义 &amp; 复制 &amp; 实例化</h3><ul>
<li>数据类创建一个只包含数据的类，<code>data</code> 关键字来修饰 class</li>
<li>编译器从主构造器中所声明的提取（?定义）了 <code>equals()/hashCode()</code>、<code>toString()</code>、<code>componentN()</code>、<code>copy()</code> 等函数；已经明确定义，不会再生成</li>
<li>条件<ul>
<li>主构造器至少包含一个参数</li>
<li>主构造器参数必须标识 <code>val</code> or <code>var</code></li>
<li>类不可声明 <code>abstract</code> <code>open</code> <code>sealed</code> <code>inner</code></li>
<li>不能继承其他类（但可以实现接口）</li>
</ul>
</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data</span> <span class="keyword">class</span> <span class="title class_">User</span>(<span class="keyword">val</span> name: String, <span class="keyword">var</span> price: <span class="built_in">Int</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 复制使用 copy 函数，可以复制对象且修改部分属性</span></span><br><span class="line"><span class="keyword">val</span> nike = User(name = <span class="string">&quot;nick&quot;</span>, price = <span class="number">899</span>)</span><br><span class="line"><span class="keyword">val</span> ig = nike.copy(name = <span class="string">&quot;ig&quot;</span>) <span class="comment">// User(name=ig, price=899)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// destruct 类结构</span></span><br><span class="line"><span class="keyword">val</span> (name, price) = ig</span><br><span class="line">println(<span class="string">&quot;<span class="variable">$name</span> is ￥<span class="variable">$price</span>&quot;</span>) <span class="comment">// ig is ￥899</span></span><br></pre></td></tr></table></figure>

<h3 id="标准数据类"><a href="#标准数据类" class="headerlink" title="标准数据类"></a>标准数据类</h3><ul>
<li>Kotlin 内置 了 <code>Pair</code> 以及 <code>Triple</code> 数据类</li>
<li>命名数据类是更好的设计选择</li>
<li>代码可读性更强而且提供了有意义的名字和属性</li>
</ul>
<h3 id="密封类"><a href="#密封类" class="headerlink" title="密封类"></a>密封类</h3><ul>
<li>表示受限的类结构</li>
<li>等同于枚举类的拓展（一个值为有限的几种类型，而不能有其他类型）</li>
<li>使用 <code>sealed</code> 来修饰类</li>
<li>密封类可以有子类，但是所有子类均内嵌在密封类的文件中</li>
<li>sealed 不能修饰 <code>interface</code> <code>abstract class</code></li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">sealed</span> <span class="keyword">class</span> <span class="title class_">Expr</span></span><br><span class="line"><span class="keyword">data</span> <span class="keyword">class</span> <span class="title class_">Const</span>(<span class="keyword">val</span> number: <span class="built_in">Double</span>) : Expr()</span><br><span class="line"><span class="keyword">data</span> <span class="keyword">class</span> <span class="title class_">Sum</span>(<span class="keyword">val</span> e1: Expr, <span class="keyword">val</span> e2: Expr) : Expr()</span><br><span class="line"><span class="keyword">object</span> NotANumber : Expr()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">eval</span><span class="params">(expr: <span class="type">Expr</span>)</span></span>: <span class="built_in">Double</span> = <span class="keyword">when</span> (expr) &#123;</span><br><span class="line">    <span class="keyword">is</span> Const -&gt; expr.number</span><br><span class="line">    <span class="keyword">is</span> Sum -&gt; eval(expr.e1) + eval(expr.e2)</span><br><span class="line">    NotANumber -&gt; <span class="built_in">Double</span>.NaN</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">eval</span><span class="params">(expr: <span class="type">Expr</span>)</span></span>: <span class="built_in">Double</span> = <span class="keyword">when</span>(expr) &#123;</span><br><span class="line">    <span class="keyword">is</span> Expr.Const -&gt; expr.number</span><br><span class="line">    <span class="keyword">is</span> Expr.Sum -&gt; eval(expr.e1) + eval(expr.e2)</span><br><span class="line">    Expr.NotANumber -&gt; <span class="built_in">Double</span>.NaN</span><br><span class="line">    <span class="comment">// 不再需要 `else` 子句，因为已经覆盖了所有的情况</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="枚举类"><a href="#枚举类" class="headerlink" title="枚举类"></a>枚举类</h3><ul>
<li>基本用法是实现一个类型安全的枚举</li>
<li>都好分隔，每个枚举常量都是一个对象</li>
<li>每个枚举都是枚举类的实例（可以被初始化）</li>
</ul>
<h3 id="枚举初始化"><a href="#枚举初始化" class="headerlink" title="枚举初始化"></a>枚举初始化</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// defined</span></span><br><span class="line"><span class="keyword">enum</span> <span class="keyword">class</span> <span class="title class_">Color</span> &#123; BLACK, RED, BLUE &#125;</span><br><span class="line"><span class="comment">// Color.BLACK 0 ；默认从 0 开始</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// initiailized</span></span><br><span class="line"><span class="keyword">enum</span> <span class="keyword">class</span> <span class="title class_">Color</span>(<span class="keyword">val</span> hex: <span class="built_in">Int</span>) &#123;</span><br><span class="line">	BLACK(<span class="number">0x000000</span>),</span><br><span class="line">	GREY(<span class="number">0xCCCCCC</span>),</span><br><span class="line">	BLUE(<span class="number">0x232323</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 声明自己的匿名类和方法、以及覆盖基类的方法</span></span><br><span class="line"><span class="keyword">enum</span> <span class="keyword">class</span> <span class="title class_">ProtocolState</span> &#123;</span><br><span class="line">	PADDING &#123;</span><br><span class="line">		<span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">state</span><span class="params">()</span></span> = OK</span><br><span class="line">	&#125;,</span><br><span class="line">	OK &#123;</span><br><span class="line">		<span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">state</span><span class="params">()</span></span> = PADDING</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="comment">// 枚举累定义成员，需要用 ; 将成员定义中枚举常量分隔开来</span></span><br><span class="line">	<span class="keyword">abstract</span> <span class="function"><span class="keyword">fun</span> <span class="title">state</span><span class="params">()</span></span>: ProtocolState</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="枚举类的使用"><a href="#枚举类的使用" class="headerlink" title="枚举类的使用"></a>枚举类的使用</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// values() -&gt; Arrau&lt;EnumClass&gt;</span></span><br><span class="line"><span class="keyword">for</span>(en <span class="keyword">in</span> Color.values()) println(en)</span><br><span class="line"><span class="comment">// valueOf(value: String) -&gt; EnumClass</span></span><br><span class="line">Color.valueOf(<span class="string">&quot;BLACK&quot;</span>) <span class="comment">// BLACK</span></span><br><span class="line"></span><br><span class="line">Color.valueOf(<span class="string">&quot;BLACK&quot;</span>).name <span class="comment">// BLACK</span></span><br><span class="line">Color.valueOf(<span class="string">&quot;BLACK&quot;</span>).ordinal <span class="comment">// 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// kotlin@1.1 support enumValues&lt;T&gt;() &amp; enumValueOf&lt;T&gt;()</span></span><br><span class="line">enumValues&lt;Color&gt;().joinToString &#123; it.name &#125;</span><br><span class="line"><span class="keyword">for</span>(v <span class="keyword">in</span> enumValues&lt;Color&gt;()) println(<span class="string">&quot;<span class="subst">$&#123;v.name&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="泛型"><a href="#泛型" class="headerlink" title="泛型"></a>泛型</h2><ul>
<li>泛型即『参数化类型』，类型参数化作用于接口、类、方法</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 泛型类的声明</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Box</span>&lt;<span class="type">T</span>&gt;(<span class="keyword">var</span> value: T)</span><br><span class="line"><span class="keyword">val</span> box: Box&lt;<span class="built_in">Double</span>&gt; = Box&lt;<span class="built_in">Double</span>&gt;(<span class="number">1.0</span>)</span><br><span class="line"><span class="keyword">val</span> triple = Box&lt;<span class="built_in">Int</span>&gt;(value = <span class="number">199</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 泛型函数的声明</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span><span class="type">&lt;T&gt;</span> <span class="title">boxOf</span><span class="params">(value: <span class="type">T</span>)</span></span> = Box(value)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 可以完整写出类型，也可以省略有编译器推断</span></span><br><span class="line">boxOf&lt;<span class="built_in">Double</span>&gt;(<span class="number">1.00</span>).value <span class="comment">// 1.0</span></span><br><span class="line">boxOf(<span class="number">1</span>).value <span class="comment">// 编译器类型推断</span></span><br></pre></td></tr></table></figure>

<h3 id="泛型约束"><a href="#泛型约束" class="headerlink" title="泛型约束"></a>泛型约束</h3><p>使用泛型约束来设定一个给定参数允许的类型</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Comoparable 的子类型可以替代 T</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T : Comparable&lt;T&gt;</span>&gt; <span class="title">sort</span><span class="params">(list: <span class="type">List</span>&lt;<span class="type">T</span>&gt;)</span></span> &#123;</span><br><span class="line">&#125;</span><br><span class="line">sort(listOf(<span class="number">1</span>,<span class="number">2</span>)) <span class="comment">// ok</span></span><br><span class="line">sort(listOf(HashMap&lt;<span class="built_in">Int</span>, String&gt;())) <span class="comment">// error</span></span><br><span class="line"><span class="comment">// HashMap&lt;Int, String&gt; 不是 Comparable&lt;HashMap&lt;Int, String&gt;&gt; 的子类型（没搞明白）</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> <span class="title">copyWhenGreater</span><span class="params">(list: <span class="type">List</span>&lt;<span class="type">T</span>&gt;, threshold: <span class="type">T</span>)</span></span>: List&lt;String&gt;</span><br><span class="line">    <span class="keyword">where</span> T : CharSequence,</span><br><span class="line">          T : Comparable&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> list.filter &#123; it &gt; threshold &#125;.map &#123; it.toString() &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="型变"><a href="#型变" class="headerlink" title="型变"></a>型变</h3><ul>
<li>Kotlin 没有通配符类型</li>
<li>声明处型变（declaration-site variance） 与 类型投射（type projections）</li>
<li>声明处型变：注解修饰符 in（消费者）、out（生产者）<ul>
<li>out 使得参数协变；只能用于输出，可以作为返回值类型，但无法作入参类型</li>
<li>in 使得参数逆变；只能用于输入，可以作为入参类型，但无法作返回值类型</li>
</ul>
</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 参数协变</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>&lt;<span class="type">out U</span>&gt;(<span class="keyword">val</span> klass: U) &#123;</span><br><span class="line">	<span class="function"><span class="keyword">fun</span> <span class="title">learn</span><span class="params">()</span></span>: U = klass</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">val</span> stua: Student&lt;<span class="built_in">Int</span>&gt; = Student(<span class="number">22</span>) <span class="comment">// .learn() 22</span></span><br><span class="line"><span class="keyword">val</span> stub: Student&lt;<span class="built_in">Double</span>&gt; = Student(<span class="number">22.99</span>) <span class="comment">// .learn() 22.99</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 参数逆变</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>&lt;<span class="type">in I</span>&gt;(klass: I) &#123;</span><br><span class="line">	<span class="function"><span class="keyword">fun</span> <span class="title">learn</span><span class="params">(a: <span class="type">I</span>)</span></span> = println(a)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> stua = Student&lt;<span class="built_in">Double</span>&gt;(<span class="string">&quot;xxx&quot;</span>)</span><br><span class="line"><span class="keyword">val</span> stub = Student&lt;<span class="built_in">Double</span>&gt;(<span class="number">22.99</span>)</span><br><span class="line">stua = stub <span class="comment">// Error inferred type is String but Double...</span></span><br></pre></td></tr></table></figure>

<h3 id="星号投射"><a href="#星号投射" class="headerlink" title="星号投射"></a>星号投射</h3><ul>
<li>Kotlin 提供语法了 star-projection 来约束泛型类型的所有实体实例都是投射的子类型</li>
<li><code>*</code> 指代了所有类型，相当于 <code>Any?</code></li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Foo&lt;<span class="keyword">out</span> T&gt;; Foo&lt;&gt; 等价于 Foo&lt;<span class="keyword">out</span> TUpper&gt;</span><br><span class="line">Foo&lt;<span class="keyword">in</span> T&gt; T 是反向协变的类型参数; Foo&lt;&gt; 等价于 Foo&lt;<span class="keyword">in</span> <span class="built_in">Nothing</span>&gt;</span><br><span class="line">所以 Foo&lt;*&gt; 对于读取值的场景，等价于 Foo&lt;<span class="keyword">out</span> TUpper&gt;</span><br><span class="line">			  对于写入值的场景，等价于 Foo&lt;<span class="keyword">in</span> <span class="built_in">Nothing</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ex.</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Function</span>&lt;<span class="type">in T, out U</span>&gt;</span><br><span class="line"><span class="comment">// 可以出现一下几种星号投射</span></span><br><span class="line">Function&lt;*, String&gt; 等价于 Function&lt;<span class="keyword">in</span> <span class="built_in">Nothing</span>, String&gt;</span><br><span class="line">Function&lt;<span class="built_in">Int</span>, *&gt; 等价于 Function&lt;<span class="built_in">Int</span>, Out Any?&gt;</span><br><span class="line">Function&lt;,&gt; 等价于 Function&lt;<span class="keyword">in</span> <span class="built_in">Nothing</span>, Out Any?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>&lt;<span class="type">T</span>&gt;(<span class="keyword">val</span> name: T, <span class="keyword">val</span> age: T)</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> s1: Student&lt;<span class="built_in">Int</span>&gt; = Student(<span class="number">782351</span>, <span class="number">17</span>)</span><br><span class="line"><span class="keyword">val</span> s2: Student&lt;*&gt; = Student(<span class="string">&quot;sily&quot;</span>, <span class="number">18</span>)</span><br><span class="line"><span class="keyword">val</span> s3: Student&lt;Any?&gt; = Student(<span class="string">&quot;sily&quot;</span>, <span class="string">&quot;20&quot;</span>)</span><br><span class="line"><span class="keyword">val</span> l: ArrayList&lt;*&gt; = arrayListOf(s1, s2, s3)</span><br></pre></td></tr></table></figure>

<h2 id="对象"><a href="#对象" class="headerlink" title="对象"></a>对象</h2><h3 id="对象表达式"><a href="#对象表达式" class="headerlink" title="对象表达式"></a>对象表达式</h3><ul>
<li>实现一个匿名内部类的对象用于方法的参数</li>
<li>通过对象表达式可以直接得到一个对象</li>
<li>在对象表达式中可以方便的访问的作用域中的其他变量</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> site = <span class="keyword">object</span> &#123;</span><br><span class="line">	<span class="keyword">var</span> name = <span class="string">&quot;yalda&quot;</span></span><br><span class="line">	<span class="keyword">val</span> site = <span class="string">&quot;yalda.cn&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">	<span class="keyword">val</span> name = <span class="string">&quot;yalda&quot;</span></span><br><span class="line">	<span class="comment">// return 匿名对象类型</span></span><br><span class="line">	<span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">learn</span><span class="params">()</span></span> = <span class="keyword">object</span> &#123;</span><br><span class="line">		<span class="keyword">val</span> course = <span class="string">&quot;<span class="variable">$name</span> 偷偷学 math&quot;</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// return Any type</span></span><br><span class="line">	<span class="function"><span class="keyword">fun</span> <span class="title">study</span><span class="params">()</span></span> = <span class="keyword">object</span> &#123;</span><br><span class="line">		<span class="keyword">val</span> course = <span class="string">&quot;<span class="variable">$name</span> english&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">fun</span> <span class="title">find</span><span class="params">()</span></span>: String &#123;</span><br><span class="line">		study().course <span class="comment">// Unresolved reference: course</span></span><br><span class="line">		<span class="keyword">return</span> learn().course <span class="comment">// math</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 为 object 表达式声明类型</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Factory</span> &#123;</span><br><span class="line">	<span class="keyword">abstract</span> <span class="keyword">val</span> course: String</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">study</span><span class="params">()</span></span> = <span class="keyword">object</span>: Factory &#123;</span><br><span class="line">	<span class="keyword">override</span> <span class="keyword">val</span> course = <span class="string">&quot;<span class="variable">$name</span> english&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="对象声明"><a href="#对象声明" class="headerlink" title="对象声明"></a>对象声明</h3><ul>
<li>使用 <code>object</code> 关键字声明一个对象</li>
<li>对象可以简化一个单例的声明</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// single instance</span></span><br><span class="line"><span class="keyword">object</span> Student &#123;</span><br><span class="line">    <span class="keyword">val</span> name: String = <span class="string">&quot;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">val</span> s = Student</span><br><span class="line"><span class="keyword">val</span> s1 = Student</span><br><span class="line">s === s1 <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 对象可以有超类型</span></span><br><span class="line"><span class="keyword">open</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="keyword">open</span> <span class="function"><span class="keyword">fun</span> <span class="title">work</span><span class="params">()</span></span> = println(<span class="string">&quot;job&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">object</span> Student: Person() &#123; <span class="comment">// 必须对 Class 进行初始化</span></span><br><span class="line">    <span class="keyword">val</span> name: String = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">work</span><span class="params">()</span></span> = println(<span class="string">&quot;study&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="keyword">object</span> Student &#123;</span><br><span class="line">	<span class="keyword">var</span> name = <span class="string">&quot;yalda&quot;</span></span><br><span class="line">	<span class="keyword">object</span> ClassRoom &#123;</span><br><span class="line">		<span class="keyword">val</span> position = <span class="string">&quot;L4&quot;</span></span><br><span class="line">		<span class="function"><span class="keyword">fun</span> <span class="title">showName</span><span class="params">()</span></span> = println(<span class="string">&quot;<span class="variable">$name</span>@N24432&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">val</span> s = Student</span><br><span class="line">s.ClassRooo.position <span class="comment">//&#x27;ClassRoom&#x27; accessed via instance refer</span></span><br><span class="line">Student.ClassRoom.showName() <span class="comment">// yalda@N24432</span></span><br></pre></td></tr></table></figure>

<h3 id="伴生对象"><a href="#伴生对象" class="headerlink" title="伴生对象"></a>伴生对象</h3><ul>
<li>一个类里面只能声明一个内部关联对象</li>
<li>伴生对象的成员类似其他语言的静态成员，但是在运行时仍然是真实对象的实例成员</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">	<span class="keyword">companion</span> <span class="keyword">object</span> ClassRoom &#123;</span><br><span class="line">		<span class="function"><span class="keyword">fun</span> <span class="title">stds</span><span class="params">()</span></span>: List&lt;Student&gt; = listOf&lt;Student&gt;(Student())</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">val</span> intance = Student.stds() <span class="comment">// [Student@23421c3]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果伴生对象未命名，则通过 &lt;class&gt;.Companion 访问</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">	<span class="keyword">companion</span> <span class="keyword">object</span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line">Student.Companion</span><br><span class="line"></span><br><span class="line"><span class="comment">// 伴生对象还可以实现接口</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Talent</span>&lt;<span class="type">out T</span>&gt; &#123;</span><br><span class="line">	<span class="function"><span class="keyword">fun</span> <span class="title">create</span><span class="params">()</span></span>: T</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">	<span class="keyword">companion</span> <span class="keyword">object</span>: Talent&lt;Student&gt; &#123;</span><br><span class="line">		<span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">create</span><span class="params">()</span></span>: Student = Student()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">Student.Companion.create() <span class="comment">// Student@20ad9418</span></span><br></pre></td></tr></table></figure>

<h3 id="对象表达式和伴生对象的语义差异"><a href="#对象表达式和伴生对象的语义差异" class="headerlink" title="对象表达式和伴生对象的语义差异"></a>对象表达式和伴生对象的语义差异</h3><ul>
<li>对象表达式在使用他们的地方立即执行</li>
<li>对象声明在第一次被访问时延迟初始化（懒人单例模式）</li>
<li>伴生对象的初始化在相应的类被加载（解析）时；与 Java 的静态初始化器语义相匹配</li>
</ul>
<h2 id="委托"><a href="#委托" class="headerlink" title="委托"></a>委托</h2><h3 id="类委托"><a href="#类委托" class="headerlink" title="类委托"></a>类委托</h3><ul>
<li>Kotlin 直接支持委托模式。优雅、简介；通过关键字 <code>by</code> 实现委托</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">IPrint</span> &#123;</span><br><span class="line">	<span class="function"><span class="keyword">fun</span> <span class="title">print</span><span class="params">()</span></span>: <span class="built_in">Unit</span></span><br><span class="line">	<span class="function"><span class="keyword">fun</span> <span class="title">connect</span><span class="params">()</span></span> = println(<span class="string">&quot;connect...&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GPrint</span>(<span class="keyword">val</span> ip: String): IPrint &#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">print</span><span class="params">()</span></span> = print(<span class="string">&quot;gprint run...&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">JiaBooPrint</span>(<span class="keyword">val</span> ip: String): IPrint &#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">print</span><span class="params">()</span></span> = print(<span class="string">&quot;jiaboo run...&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// by 子句表示，将 p 保存在 Device 的对象实例内部，编译器将会生产继承自 IPrint 接口的所有，并将调用转发给 p</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Device</span>(p: IPrint): IPrint <span class="keyword">by</span> p <span class="comment">// by 建立委托</span></span><br><span class="line"></span><br><span class="line">Device(GPrint(<span class="string">&quot;127.0.0.10&quot;</span>)).print() <span class="comment">// gprint run...</span></span><br><span class="line">Device(JiaBooPrint(<span class="string">&quot;127.0.0.1&quot;</span>)).print() <span class="comment">// jiaboo run...</span></span><br></pre></td></tr></table></figure>

<h3 id="属性委托"><a href="#属性委托" class="headerlink" title="属性委托"></a>属性委托</h3><ul>
<li>将一个类的某个属性委托给一个代理类，实现对该类属性的统一管理</li>
<li>该属性的 get &#x2F; set 将被委托给代理类的 getValue() &#x2F; setValue()</li>
</ul>
<p><code>val/var &lt;属性名&gt;: &lt;类型&gt; by &lt;表达式&gt;</code></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> kotlin.reflect.KProperty</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">	<span class="keyword">var</span> credit: <span class="built_in">Double</span> <span class="keyword">by</span> Query()</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 委托的类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Query</span> &#123;</span><br><span class="line">	<span class="keyword">operator</span> <span class="function"><span class="keyword">fun</span> <span class="title">getValue</span><span class="params">(thisRef: <span class="type">Any</span>?, property: <span class="type">KProperty</span>&lt;*&gt;)</span></span>: <span class="built_in">Double</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">99.91</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// 如果是 val 声明则不需要提供 setValue 函数</span></span><br><span class="line">	<span class="keyword">operator</span> <span class="function"><span class="keyword">fun</span> <span class="title">setValue</span><span class="params">(thisRef: <span class="type">Any</span>?, property: <span class="type">KProperty</span>&lt;*&gt;, value: <span class="type">Double</span>)</span></span>: <span class="built_in">Double</span> &#123;</span><br><span class="line">		<span class="comment">//</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">Student().credit <span class="comment">// 99.91</span></span><br></pre></td></tr></table></figure>

<h3 id="标准委托"><a href="#标准委托" class="headerlink" title="标准委托"></a>标准委托</h3><p>Kotlin 内置很多工厂方法来实现属性的委托</p>
<ul>
<li>延迟属性 Lazy<ul>
<li><code>Lazy&lt;T&gt;: by lazy</code></li>
</ul>
</li>
<li>可观察属性 Observable<ul>
<li><code>by Delegates.observable()</code></li>
</ul>
</li>
<li>属性存储在映射中<ul>
<li><code>by map</code></li>
<li>常用于 JSON 解析，或者其他动态事情</li>
</ul>
</li>
<li>Not Null<ul>
<li><code>by Delegates.notNull&lt;String&gt;()</code></li>
<li>常用于初始化时无法确定属性值的场景</li>
</ul>
</li>
<li>局部委托属性<ul>
<li><code>val memorizedFoo by lazy(computeFoo)</code></li>
</ul>
</li>
</ul>
<h3 id="委托的翻译规则"><a href="#委托的翻译规则" class="headerlink" title="委托的翻译规则"></a>委托的翻译规则</h3><ul>
<li>thisRef 必须于属性所有者类型相同或其超类型</li>
<li>property 必须是类型 <code>KProperty&lt;*&gt;</code> 或其超类型</li>
<li>对于 mutable 属性，除 getValue() 函数还必须提供 setValue()<ul>
<li>property 必须是类型 <code>KProperty&lt;*&gt;</code> 或其超类型</li>
<li>new value 必须和属性类型相同或其超类型</li>
</ul>
</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">	<span class="keyword">var</span> prop: Type <span class="keyword">by</span> MyDelegate()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// java</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">	<span class="keyword">val</span> prop$delegate = MyDelegate()</span><br><span class="line">	<span class="keyword">var</span> prop: Type</span><br><span class="line">		<span class="keyword">get</span>() = prop$delegate.getValue(<span class="keyword">this</span>,  <span class="keyword">this</span>::prop)</span><br><span class="line">		<span class="keyword">set</span>(value: Type) = prop$delegate.setValue(<span class="keyword">this</span>, <span class="keyword">this</span>::prop, value)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="提供委托"><a href="#提供委托" class="headerlink" title="提供委托"></a>提供委托</h3><p>通过定义 <code>provideDelegate</code> 操作符</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ResourceLoader</span>&lt;<span class="type">T</span>&gt;(id: ResourceID&lt;T&gt;) &#123;</span><br><span class="line">    <span class="keyword">operator</span> <span class="function"><span class="keyword">fun</span> <span class="title">provideDelegate</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">            thisRef: <span class="type">MyUI</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">            prop: <span class="type">KProperty</span>&lt;*&gt;</span></span></span><br><span class="line"><span class="params"><span class="function">    )</span></span>: ReadOnlyProperty&lt;MyUI, T&gt; &#123;</span><br><span class="line">        checkProperty(thisRef, prop.name)</span><br><span class="line">        <span class="comment">// 创建委托</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">checkProperty</span><span class="params">(thisRef: <span class="type">MyUI</span>, name: <span class="type">String</span>)</span></span> &#123; …… &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> <span class="title">bindResource</span><span class="params">(id: <span class="type">ResourceID</span>&lt;<span class="type">T</span>&gt;)</span></span>: ResourceLoader&lt;T&gt; &#123; …… &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyUI</span> &#123;</span><br><span class="line">    <span class="keyword">val</span> image <span class="keyword">by</span> bindResource(ResourceID.image_id)</span><br><span class="line">    <span class="keyword">val</span> text <span class="keyword">by</span> bindResource(ResourceID.text_id)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
	  
	</div>

	<div>
  	<center>
	<div class="pagination">

    
    
    <a href="/2022/kotlin-vs-java/" type="button" class="btn btn-default"><i
                class="fa fa-arrow-circle-o-left"></i> Prev</a>
    

    <a href="/" type="button" class="btn btn-default"><i class="fa fa-home"></i>Home</a>
    
    <a href="/2022/swift-exp-collect/" type="button" class="btn btn-default ">Next<i
                class="fa fa-arrow-circle-o-right"></i></a>
    

    
</div>

    </center>
	</div>
	
	<!-- comment -->
	
<section id="comment">
    <h2 class="title">Comments</h2>

    
</section>


	</div> <!-- col-md-9/col-md-12 -->
		
	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2022-05-14 
	</div>
	

	<!-- categories -->
    

	<!-- tags -->
	
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#tags"><i class="fa fa-tags"></i></a>		  
    <ul id="tags" class="tag_box list-unstyled collapse in">	  
	    
  <li><a href="/tags/lang-kotlin/">lang/kotlin<span>2</span></a></li>
    </ul>
	</div>
		

	<!-- toc -->
	<div class="meta-widget">
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

	</div>
		

</div><!-- row -->



	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
   &copy; 2015 - 2023 Yalda Guo 
  <br />
  Power by Hexo and Freemind.386
</p>
 </footer>
</div> <!-- container-narrow -->
  


  <a id="gotop" href="#">
  <span>⬆︎TOP</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script>

 
<script type="text/javascript">
  var search_path = 'search.xml';
  if (search_path.length == 0) {
    search_path = 'search.xml';
  }
  var path = '/' + search_path;
  searchFunc(path, 'local-search-input', 'local-search-result');
</script>


</body>
   </html>
